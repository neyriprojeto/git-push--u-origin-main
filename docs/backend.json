{
  "entities": {
    "Member": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Member",
      "type": "object",
      "description": "Represents a member of the church.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Member entity."
        },
        "firstName": {
          "type": "string",
          "description": "The first name of the member."
        },
        "lastName": {
          "type": "string",
          "description": "The last name of the member."
        },
        "email": {
          "type": "string",
          "description": "The email address of the member.",
          "format": "email"
        },
        "phoneNumber": {
          "type": "string",
          "description": "The phone number of the member."
        },
        "address": {
          "type": "string",
          "description": "The address of the member."
        },
        "dateOfBirth": {
          "type": "string",
          "description": "The date of birth of the member.",
          "format": "date-time"
        },
        "membershipDate": {
          "type": "string",
          "description": "The date when the member joined the church.",
          "format": "date-time"
        },
        "groupIds": {
          "type": "array",
          "description": "References to Groups. (Relationship: Member N:N Group)",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "firstName",
        "lastName",
        "email",
        "phoneNumber",
        "address",
        "dateOfBirth",
        "membershipDate"
      ]
    },
    "Group": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Group",
      "type": "object",
      "description": "Represents a group within the church (e.g., youth group, choir).",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Group entity."
        },
        "name": {
          "type": "string",
          "description": "The name of the group."
        },
        "description": {
          "type": "string",
          "description": "A description of the group."
        },
        "memberIds": {
          "type": "array",
          "description": "References to Members. (Relationship: Group N:N Member)",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "name",
        "description"
      ]
    },
    "ChurchInfo": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ChurchInfo",
      "type": "object",
      "description": "Represents the church's banner, pastor information, and pastoral message.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the ChurchInfo entity."
        },
        "bannerImageUrl": {
          "type": "string",
          "description": "URL of the church banner image.",
          "format": "uri"
        },
        "pastorImageUrl": {
          "type": "string",
          "description": "URL of the pastor's image.",
          "format": "uri"
        },
        "pastorName": {
          "type": "string",
          "description": "The name of the pastor."
        },
        "pastoralMessage": {
          "type": "string",
          "description": "The pastoral message from the pastor."
        },
        "aboutUs": {
          "type": "string",
          "description": "The 'about us' section for the mini site."
        }
      },
      "required": [
        "id",
        "bannerImageUrl",
        "pastorImageUrl",
        "pastorName",
        "pastoralMessage",
        "aboutUs"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/members/{memberId}",
        "definition": {
          "entityName": "Member",
          "schema": {
            "$ref": "#/backend/entities/Member"
          },
          "description": "Stores member information. Each document represents a church member.",
          "params": [
            {
              "name": "memberId",
              "description": "The unique identifier for the member."
            }
          ]
        }
      },
      {
        "path": "/groups/{groupId}",
        "definition": {
          "entityName": "Group",
          "schema": {
            "$ref": "#/backend/entities/Group"
          },
          "description": "Stores group information. Each document represents a group within the church.",
          "params": [
            {
              "name": "groupId",
              "description": "The unique identifier for the group."
            }
          ]
        }
      },
      {
        "path": "/churchInfo/{churchInfoId}",
        "definition": {
          "entityName": "ChurchInfo",
          "schema": {
            "$ref": "#/backend/entities/ChurchInfo"
          },
          "description": "Stores church information, including banner image URL, pastor information, and pastoral message.  There should only ever be ONE document in this collection.",
          "params": [
            {
              "name": "churchInfoId",
              "description": "The unique identifier for the church information (e.g., 'main')."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to manage church member data, group affiliations, and church information for the AdKairos Connect app. The structure prioritizes authorization independence and supports secure list operations. User authentication is handled via Firebase Auth, and roles are managed within the database using membership maps. This approach avoids hierarchical authorization dependencies and simplifies security rules.\n\nTo ensure **Authorization Independence**, the `groupIds` within each `Member` document, as well as the `memberIds` within each `Group` document are arrays of simple ID values, and do not require `get()` calls in the rules. For collaborative access, the structure uses a `members` map on the `/groups/{groupId}` document, containing user IDs as keys and their roles within the group as values. The `ChurchInfo` collection contains a single document with the church's banner image URL, pastor information, and pastoral message. This data is publicly accessible.\n\nTo support **QAPs**, the separation of member data and group data into distinct collections ensures that list operations can be performed securely. Rules will use `exists()` to determine access for individual members or groups, preventing unauthorized data retrieval."
  }
}