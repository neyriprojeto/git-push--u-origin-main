
{
  "entities": {
    "Member": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Member",
      "type": "object",
      "description": "Represents a member of the church.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Member entity."
        },
        "firstName": {
          "type": "string",
          "description": "The first name of the member."
        },
        "lastName": {
          "type": "string",
          "description": "The last name of the member."
        },
        "email": {
          "type": "string",
          "description": "The email address of the member.",
          "format": "email"
        },
        "phoneNumber": {
          "type": "string",
          "description": "The phone number of the member."
        },
        "address": {
          "type": "string",
          "description": "The address of the member."
        },
        "dateOfBirth": {
          "type": "string",
          "description": "The date of birth of the member.",
          "format": "date-time"
        },
        "membershipDate": {
          "type": "string",
          "description": "The date when the member joined the church.",
          "format": "date-time"
        },
        "congregacao": {
          "type": "string",
          "description": "The congregation the member belongs to. Used for role-based access."
        },
        "groupIds": {
          "type": "array",
          "description": "References to Groups. (Relationship: Member N:N Group)",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "firstName",
        "lastName",
        "email",
        "phoneNumber",
        "address",
        "dateOfBirth",
        "membershipDate",
        "congregacao"
      ]
    },
    "Group": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Group",
      "type": "object",
      "description": "Represents a group within the church (e.g., youth group, choir).",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Group entity."
        },
        "name": {
          "type": "string",
          "description": "The name of the group."
        },
        "description": {
          "type": "string",
          "description": "A description of the group."
        },
        "memberIds": {
          "type": "array",
          "description": "References to Members. (Relationship: Group N:N Member)",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "name",
        "description"
      ]
    },
    "ChurchInfo": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ChurchInfo",
      "type": "object",
      "description": "Represents the church's banner, pastor information, and pastoral message.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the ChurchInfo entity."
        },
        "bannerImageUrl": {
          "type": "string",
          "description": "URL of the church banner image.",
          "format": "uri"
        },
        "pastorImageUrl": {
          "type": "string",
          "description": "URL of the pastor's image.",
          "format": "uri"
        },
        "pastorName": {
          "type": "string",
          "description": "The name of the pastor."
        },
        "pastoralMessage": {
          "type": "string",
          "description": "The pastoral message from the pastor."
        },
        "aboutUs": {
          "type": "string",
          "description": "The 'about us' section for the mini site."
        },
        "instagramUrl": {
          "type": "string",
          "description": "URL for the church's Instagram profile.",
          "format": "uri"
        },
        "youtubeUrl": {
          "type": "string",
          "description": "URL for the church's YouTube channel.",
          "format": "uri"
        },
        "websiteUrl": {
          "type": "string",
          "description": "URL for the church's external website.",
          "format": "uri"
        },
        "radioUrl": {
          "type": "string",
          "description": "URL for the embedded radio player.",
          "format": "uri"
        },
        "radioPageUrl": {
          "type": "string",
          "description": "URL for the radio page to be opened in a new tab.",
          "format": "uri"
        },
        "pastorSignatureUrl": {
          "type": "string",
          "description": "URL of the pastor's signature image.",
          "format": "uri"
        },
        "conventionLogo1Url": {
          "type": "string",
          "description": "URL for the first convention logo.",
          "format": "uri"
        },
        "conventionLogo2Url": {
          "type": "string",
          "description": "URL for the second convention logo.",
          "format": "uri"
        }
      },
      "required": [
        "id",
        "bannerImageUrl",
        "pastorImageUrl",
        "pastorName",
        "pastoralMessage",
        "aboutUs"
      ]
    },
    "Leader": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Leader",
      "type": "object",
      "description": "Represents a member of the executive committee displayed on the homepage.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Leader."
        },
        "name": {
          "type": "string",
          "description": "The name of the leader."
        },
        "role": {
          "type": "string",
          "description": "The role or function of the leader (e.g., '1º Vice-presidente')."
        },
        "imageUrl": {
          "type": "string",
          "description": "URL of the leader's photo.",
          "format": "uri"
        },
        "email": {
          "type": "string",
          "description": "The email address of the leader.",
          "format": "email"
        },
        "order": {
          "type": "number",
          "description": "A number used for ordering the leaders in the list."
        }
      },
      "required": [
        "id",
        "name",
        "role"
      ]
    },
    "DocumentTemplate": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "DocumentTemplate",
      "type": "object",
      "description": "Represents a template for generating documents like letters of recommendation.",
      "properties": {
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string",
          "description": "Name of the template (e.g., 'Carta de Recomendação')."
        }
      },
      "required": [
        "id",
        "name"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/members/{memberId}",
        "definition": {
          "entityName": "Member",
          "schema": {
            "$ref": "#/backend/entities/Member"
          },
          "description": "Stores member information. Each document represents a church member.",
          "params": [
            {
              "name": "memberId",
              "description": "The unique identifier for the member."
            }
          ]
        }
      },
      {
        "path": "/groups/{groupId}",
        "definition": {
          "entityName": "Group",
          "schema": {
            "$ref": "#/backend/entities/Group"
          },
          "description": "Stores group information. Each document represents a group within the church.",
          "params": [
            {
              "name": "groupId",
              "description": "The unique identifier for the group."
            }
          ]
        }
      },
      {
        "path": "/churchInfo/{churchInfoId}",
        "definition": {
          "entityName": "ChurchInfo",
          "schema": {
            "$ref": "#/backend/entities/ChurchInfo"
          },
          "description": "Stores church information, including banner image URL, pastor information, and pastoral message.  There should only ever be ONE document in this collection.",
          "params": [
            {
              "name": "churchInfoId",
              "description": "The unique identifier for the church information (e.g., 'main')."
            }
          ]
        }
      },
      {
        "path": "/leaders/{leaderId}",
        "definition": {
          "entityName": "Leader",
          "schema": {
            "$ref": "#/backend/entities/Leader"
          },
          "description": "Stores executive committee leader information for public display on the homepage.",
          "params": [
            {
              "name": "leaderId",
              "description": "The unique identifier for the leader."
            }
          ]
        }
      },
      {
        "path": "/documentTemplates/{templateId}",
        "definition": {
          "entityName": "DocumentTemplate",
          "schema": {
            "$ref": "#/backend/entities/DocumentTemplate"
          },
          "description": "Stores templates for official documents.",
          "params": [
            {
              "name": "templateId",
              "description": "The unique identifier for the template (e.g., 'recommendation-letter')."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to manage church member data, group affiliations, and church information for the AdKairos Connect app. The structure prioritizes authorization independence and supports secure list operations. User authentication is handled via Firebase Auth, and roles are managed within the database using membership maps. This approach avoids hierarchical authorization dependencies and simplifies security rules.\n\nTo ensure **Authorization Independence**, the `groupIds` within each `Member` document, as well as the `memberIds` within each `Group` document are arrays of simple ID values, and do not require `get()` calls in the rules. For collaborative access, the structure uses a `members` map on the `/groups/{groupId}` document, containing user IDs as keys and their roles within the group as values. The `ChurchInfo` collection contains a single document with the church's banner image URL, pastor information, and pastoral message. This data is publicly accessible. The `leaders` collection stores a manually curated list of executive committee members for public display. The `documentTemplates` collection will store background images and other metadata for generating official documents."
  }
}
